{"version":3,"file":"FirebaseRecaptcha.js","sourceRoot":"","sources":["../src/FirebaseRecaptcha.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,uBAAuB,EAAoB,MAAM,oBAAoB,CAAC;AAC/E,OAAO,KAAK,KAAK,MAAM,OAAO,CAAC;AAC/B,OAAO,EAAE,OAAO,EAAE,MAAM,sBAAsB,CAAC;AAS/C,SAAS,gBAAgB,CAAC,cAAgC,EAAE,eAAwB;IAClF,eAAe,GAAG,eAAe,IAAI,QAAQ,CAAC;IAC9C,OAAO;QACL,OAAO,EAAE,WAAW,cAAc,CAAC,UAAU,EAAE;QAC/C,IAAI,EAAE;;;;;;sDAM4C,eAAe;sDACf,eAAe;4DACT,IAAI,CAAC,SAAS,CACpE,cAAc,CACf;;;;;;;;;;;;;;;;;;;;;;;;eAwBU;KACZ,CAAC;AACJ,CAAC;AAED,MAAM,CAAC,OAAO,UAAU,iBAAiB,CAAC,KAAY;IACpD,MAAM,EAAE,cAAc,EAAE,eAAe,EAAE,QAAQ,EAAE,MAAM,EAAE,GAAG,UAAU,EAAE,GAAG,KAAK,CAAC;IACnF,IAAI,CAAC,cAAc,EAAE;QACnB,OAAO,CAAC,KAAK,CACX,wJAAwJ,CACzJ,CAAC;QACF,OAAO,IAAI,CAAC;KACb;IACD,OAAO,CACL,CAAC,OAAO,CACN,iBAAiB,CACjB,gCAAgC,CAChC,eAAe,CACf,mBAAmB,CACnB,gBAAgB,CAAC,QAAQ,CACzB,MAAM,CAAC,CAAC,gBAAgB,CAAC,cAAc,EAAE,eAAe,CAAC,CAAC,CAC1D,SAAS,CAAC,CAAC,KAAK,CAAC,EAAE;QACjB,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;QAChD,QAAQ,IAAI,CAAC,IAAI,EAAE;YACjB,KAAK,MAAM;gBACT,IAAI,MAAM,EAAE;oBACV,MAAM,EAAE,CAAC;iBACV;gBACD,MAAM;YACR,KAAK,QAAQ;gBACX,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBACrB,MAAM;SACT;IACH,CAAC,CAAC,CACF,IAAI,UAAU,CAAC,EACf,CACH,CAAC;AACJ,CAAC;AAED,iBAAiB,CAAC,YAAY,GAAG;IAC/B,cAAc,EAAE,uBAAuB;CACxC,CAAC","sourcesContent":["import { DEFAULT_WEB_APP_OPTIONS, IFirebaseOptions } from 'expo-firebase-core';\nimport * as React from 'react';\nimport { WebView } from 'react-native-webview';\n\ninterface Props extends React.ComponentProps<typeof WebView> {\n  firebaseConfig?: IFirebaseOptions;\n  firebaseVersion?: string;\n  onLoad?: () => any;\n  onVerify: (token: string) => any;\n}\n\nfunction getWebviewSource(firebaseConfig: IFirebaseOptions, firebaseVersion?: string) {\n  firebaseVersion = firebaseVersion || '7.12.0';\n  return {\n    baseUrl: `https://${firebaseConfig.authDomain}`,\n    html: `\n<!DOCTYPE html><html>\n<head>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n    <meta name=\"HandheldFriendly\" content=\"true\">\n    <script src=\"https://www.gstatic.com/firebasejs/${firebaseVersion}/firebase-app.js\"></script>\n    <script src=\"https://www.gstatic.com/firebasejs/${firebaseVersion}/firebase-auth.js\"></script>\n    <script type=\"text/javascript\">firebase.initializeApp(${JSON.stringify(\n      firebaseConfig\n    )});</script>\n    <script src=\"https://www.google.com/recaptcha/api.js\"></script>\n</head>\n<body>\n    <div id=\"recaptcha-cont\" class=\"g-recaptcha\"></div>\n    <script>\n    function onloadCallback() {\n        window.ReactNativeWebView.postMessage(JSON.stringify({\n          type: 'load'\n        }));\n        window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier(\"recaptcha-cont\", {\n        size: \"normal\",\n        callback: function(response) {\n            window.ReactNativeWebView.postMessage(JSON.stringify({\n              type: 'verify',\n              token: response\n            }));\n        }\n        });\n        window.recaptchaVerifier.render();\n      }\n    }\n    </script>\n    <script src=\"https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit\"></script>\n</body></html>`,\n  };\n}\n\nexport default function FirebaseRecaptcha(props: Props) {\n  const { firebaseConfig, firebaseVersion, onVerify, onLoad, ...otherProps } = props;\n  if (!firebaseConfig) {\n    console.error(\n      `FirebaseRecaptcha: Missing firebase web configuration. Please set the \"expo.web.config.firebase\" field in \"app.json\" or use the \"firebaseConfig\" prop.`\n    );\n    return null;\n  }\n  return (\n    <WebView\n      javaScriptEnabled\n      automaticallyAdjustContentInsets\n      scalesPageToFit\n      startInLoadingState\n      mixedContentMode=\"always\"\n      source={getWebviewSource(firebaseConfig, firebaseVersion)}\n      onMessage={event => {\n        const data = JSON.parse(event.nativeEvent.data);\n        switch (data.type) {\n          case 'load':\n            if (onLoad) {\n              onLoad();\n            }\n            break;\n          case 'verify':\n            onVerify(data.token);\n            break;\n        }\n      }}\n      {...otherProps}\n    />\n  );\n}\n\nFirebaseRecaptcha.defaultProps = {\n  firebaseConfig: DEFAULT_WEB_APP_OPTIONS,\n};\n"]}